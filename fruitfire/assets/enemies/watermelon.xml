<body>
    <name>Watermelon</name>
    <type>
        <i>boss</i>
    </type>

    <size>24</size>
    <health>100</health>
    <colors>
        <i>14</i>
        <i>15</i>
    </colors>
    <location x="0" y="232"/>

    <textures>
        <texture name="left">
            <location x="0" y="0" w="24" h="48"/>
        </texture>
        <texture name="right">
            <location x="24" y="0" w="24" h="48"/>
        </texture>
        <texture name="middle">
            <location x="48" y="0" w="8" h="48"/>
        </texture>
        <texture name="eyes-left" crop="true">
            <location x="56" y="0" w="16" h="8"/>
        </texture>
        <texture name="eyes-right" crop="true">
            <location x="56" y="8" w="16" h="8"/>
        </texture>
        <texture name="shadow-left">
            <location x="72" y="0" w="24" h="48"/>
        </texture>
        <texture name="shadow-right">
            <location x="96" y="0" w="24" h="48"/>
        </texture>
        <texture name="shadow-middle">
            <location x="120" y="0" w="8" h="48"/>
        </texture>
    </textures>

    <components>
        <component id="shadow-left">
            <texture>shadow-left</texture>
            <opacity>0.5</opacity>
            <offset x="-15" y="4"/>
        </component>
        <component id="shadow-right">
            <texture>shadow-right</texture>
            <opacity>0.5</opacity>
            <offset x="11" y="4"/>
        </component>

        <component id="body-left" body="true">
            <texture>left</texture>
            <type>outlined</type>
            <offset x="-13" y="0"/>
        </component>
        <component id="body-right" body="true">
            <texture>right</texture>
            <type>outlined</type>
            <offset x="13" y="0"/>
        </component>

        <component id="eyes-left">
            <texture>eyes-left</texture>
        </component>
        <component id="eyes-right">
            <texture>eyes-right</texture>
        </component>
    </components>

    <functions>
        <function name="place-sides">
            <args>
                <i>dir</i>
                <i>spacing</i>
            </args>
            <commands>
                <set>
                    <prop>arg:dir</prop>
                    <value><op>
                        <left><get>arg:dir</get></left>
                        <op>*</op>
                        <right><json>-1</json></right>
                    </op></value>
                </set>
                <set>
                    <prop>dirX</prop>
                    <value><call>
                        <func>util.cos</func>
                        <args>
                            <get>arg:dir</get>
                        </args>
                    </call></value>
                </set>
                <set>
                    <prop>dirY</prop>
                    <value><call>
                        <func>util.sin</func>
                        <args>
                            <get>arg:dir</get>
                        </args>
                    </call></value>
                </set>
                <set>
                    <prop>innerWidth</prop>
                    <value><op>
                        <left><op>
                            <left><get>nSlices</get></left>
                            <op>*</op>
                            <right><json>8</json></right>
                        </op></left>
                        <op>+</op>
                        <right><op>
                            <left><op>
                                <left><get>nSlices</get></left>
                                <op>+</op>
                                <right><json>1</json></right>
                            </op></left>
                            <op>*</op>
                            <right><get>arg:spacing</get></right>
                        </op></right>
                    </op></value>
                </set>
                <set>
                    <prop>edgeDiameter</prop>
                    <value><op>
                        <left><get>innerWidth</get></left>
                        <op>+</op>
                        <right><json>24</json></right>
                    </op></value>
                </set>
                <set>
                    <prop>edgeRadius</prop>
                    <value><op>
                        <left><get>edgeDiameter</get></left>
                        <op>/</op>
                        <right><json>2</json></right>
                    </op></value>
                </set>
                <set>
                    <prop>~body-left.offset.x</prop>
                    <value><op>
                        <left><get>edgeRadius</get></left>
                        <op>*</op>
                        <right><op>
                            <left><get>dirX</get></left>
                            <op>*</op>
                            <right><json>-1</json></right>
                        </op></right>
                    </op></value>
                </set>
                <set>
                    <prop>~body-left.offset.y</prop>
                    <value><op>
                        <left><get>edgeRadius</get></left>
                        <op>*</op>
                        <right><op>
                            <left><get>dirY</get></left>
                            <op>*</op>
                            <right><json>-1</json></right>
                        </op></right>
                    </op></value>
                </set>
                <set>
                    <prop>~body-right.offset.x</prop>
                    <value><op>
                        <left><get>edgeRadius</get></left>
                        <op>*</op>
                        <right><op>
                            <left><get>dirX</get></left>
                            <op>*</op>
                            <right><json>1</json></right>
                        </op></right>
                    </op></value>
                </set>
                <set>
                    <prop>~body-right.offset.y</prop>
                    <value><op>
                        <left><get>edgeRadius</get></left>
                        <op>*</op>
                        <right><op>
                            <left><get>dirY</get></left>
                            <op>*</op>
                            <right><json>1</json></right>
                        </op></right>
                    </op></value>
                </set>
                <call>
                    <func>~shadow-left.offset.set</func>
                    <args>
                        <get>~body-left.offset</get>
                    </args>
                </call>
                <call>
                    <func>~shadow-left.offset.iadd</func>
                    <args>
                        <json>[-2, 4]</json>
                    </args>
                </call>
                <call>
                    <func>~shadow-right.offset.set</func>
                    <args>
                        <get>~body-right.offset</get>
                    </args>
                </call>
                <call>
                    <func>~shadow-right.offset.iadd</func>
                    <args>
                        <json>[-2, 4]</json>
                    </args>
                </call>
                <call>
                    <func>~eyes-left.offset.set</func>
                    <args>
                        <call>
                            <func>getLookingOffset</func>
                            <args></args>
                        </call>
                    </args>
                </call>
                <call>
                    <func>~eyes-left.offset.iadd</func>
                    <args>
                        <json>[-7, 16]</json>
                    </args>
                </call>
                <call>
                    <func>~eyes-right.offset.set</func>
                    <args>
                        <call>
                            <func>getLookingOffset</func>
                            <args></args>
                        </call>
                    </args>
                </call>
                <call>
                    <func>~eyes-right.offset.iadd</func>
                    <args>
                        <json>[7, 16]</json>
                    </args>
                </call>
                <set>
                    <prop>~eyes-left.offset.x</prop>
                    <value><op>
                        <left><get>~eyes-left.offset.x</get></left>
                        <op>-</op>
                        <right><op>
                            <left><get>innerWidth</get></left>
                            <op>/</op>
                            <right><json>2</json></right>
                        </op></right>
                    </op></value>
                </set>
                <set>
                    <prop>~eyes-right.offset.x</prop>
                    <value><op>
                        <left><get>~eyes-right.offset.x</get></left>
                        <op>+</op>
                        <right><op>
                            <left><get>innerWidth</get></left>
                            <op>/</op>
                            <right><json>2</json></right>
                        </op></right>
                    </op></value>
                </set>
                <set>
                    <prop>~eyes-left.offset.y</prop>
                    <value><op>
                        <left><get>~eyes-left.offset.y</get></left>
                        <op>*</op>
                        <right><json>-1</json></right>
                    </op></value>
                </set>
                <set>
                    <prop>~eyes-right.offset.y</prop>
                    <value><op>
                        <left><get>~eyes-right.offset.y</get></left>
                        <op>*</op>
                        <right><json>-1</json></right>
                    </op></value>
                </set>
                <call>
                    <func>~eyes-left.offset.irotateOrigin</func>
                    <args>
                        <op>
                            <left><get>arg:dir</get></left>
                            <op>*</op>
                            <right><json>1</json></right>
                        </op>
                    </args>
                </call>
                <call>
                    <func>~eyes-right.offset.irotateOrigin</func>
                    <args>
                        <op>
                            <left><get>arg:dir</get></left>
                            <op>*</op>
                            <right><json>1</json></right>
                        </op>
                    </args>
                </call>
                <set>
                    <prop>~body-left.dir</prop>
                    <value><get>arg:dir</get></value>
                </set>
                <set>
                    <prop>~body-right.dir</prop>
                    <value><get>arg:dir</get></value>
                </set>
                <set>
                    <prop>~shadow-left.dir</prop>
                    <value><get>~body-left.dir</get></value>
                </set>
                <set>
                    <prop>~shadow-right.dir</prop>
                    <value><get>~body-right.dir</get></value>
                </set>
                <set>
                    <prop>~eyes-left.dir</prop>
                    <value><get>arg:dir</get></value>
                </set>
                <set>
                    <prop>~eyes-right.dir</prop>
                    <value><get>arg:dir</get></value>
                </set>
                <set>
                    <prop>_arg:dir</prop>
                    <value><get>arg:dir</get></value>
                </set>
                <set>
                    <prop>_arg:spacing</prop>
                    <value><get>arg:spacing</get></value>
                </set>
                <for>
                    <of><get>slices</get></of>
                    <body>
                        <set>
                            <prop>slice</prop>
                            <value><get>arg:value</get></value>
                        </set>
                        <set>
                            <prop>sliceX</prop>
                            <value><op>
                                <left><op>
                                    <left><get>innerWidth</get></left>
                                    <op>/</op>
                                    <right><json>-2</json></right>
                                </op></left>
                                <op>+</op>
                                <right><op>
                                    <left><op>
                                        <left><op>
                                            <left><get>arg:i</get></left>
                                            <op>+</op>
                                            <right><json>0.5</json></right>
                                        </op></left>
                                        <op>*</op>
                                        <right><json>8</json></right>
                                    </op></left>
                                    <op>+</op>
                                    <right><op>
                                        <left><op>
                                            <left><get>arg:i</get></left>
                                            <op>+</op>
                                            <right><json>1</json></right>
                                        </op></left>
                                        <op>*</op>
                                        <right><get>_arg:spacing</get></right>
                                    </op></right>
                                </op></right>
                            </op></value>
                        </set>
                        <set>
                            <prop>slice.pos.x</prop>
                            <value><op>
                                <left><get>pos.x</get></left>
                                <op>+</op>
                                <right><op>
                                    <left><get>sliceX</get></left>
                                    <op>*</op>
                                    <right><get>dirX</get></right>
                                </op></right>
                            </op></value>
                        </set>
                        <set>
                            <prop>slice.pos.y</prop>
                            <value><op>
                                <left><get>pos.y</get></left>
                                <op>-</op>
                                <right><op>
                                    <left><get>sliceX</get></left>
                                    <op>*</op>
                                    <right><get>dirY</get></right>
                                </op></right>
                            </op></value>
                        </set>
                        <set>
                            <prop>slice.dir</prop>
                            <value><op>
                                <left><get>_arg:dir</get></left>
                                <op>*</op>
                                <right><json>-1</json></right>
                            </op></value>
                        </set>
                        <set>
                            <prop>slice.delayDeath</prop>
                            <value><json>0</json></value>
                        </set>
                        <set>
                            <prop>sliceBodyComponent</prop>
                            <value><call>
                                <func>slice.getComponent</func>
                                <args>
                                    <json>"body"</json>
                                </args>
                            </call></value>
                        </set>
                        <if>
                            <cond><get>damageFlash</get></cond>
                            <true>
                                <set>
                                    <prop>sliceBodyComponent.type</prop>
                                    <value><json>"white + outlined"</json></value>
                                </set>
                            </true>
                            <false>
                                <set>
                                    <prop>sliceBodyComponent.type</prop>
                                    <value><json>"outlined"</json></value>
                                </set>
                            </false>
                        </if>
                    </body>
                </for>
            </commands>
        </function>
    </functions>

    <animations>
        <animation name="walking" loop="true">
        </animation>
        <animation name="attack3">
            <keyframes>
                <keyframe wait="0.25">
                    <start>
                        <set>
                            <prop>_attack3DirOffset</prop>
                            <value><op>
                                <left><call>
                                    <func>Math.random</func>
                                    <args></args>
                                </call></left>
                                <op>map-rg</op>
                                <right><json>[[0, 1], [0, 360]]</json></right>
                            </op></value>
                        </set>
                        <for>
                            <start><json>0</json></start>
                            <stop><json>12</json></stop>
                            <body>
                                <call>
                                    <func>engine.rootEntity.addEntity</func>
                                    <args>
                                        <call>
                                            <func>createProjectile</func>
                                            <args>
                                                <json>"power-5"</json>
                                                <call>
                                                    <func>util.choose</func>
                                                    <args>
                                                        <json>[15, 16, 19]</json>
                                                    </args>
                                                </call>
                                                <json>0.05</json>
                                                <json>1</json>
                                                <get>pos</get>
                                                <op>
                                                    <left><get>_attack3DirOffset</get></left>
                                                    <op>+</op>
                                                    <right><op>
                                                        <left><json>30</json></left>
                                                        <op>*</op>
                                                        <right><get>arg:i</get></right>
                                                    </op></right>
                                                </op>
                                            </args>
                                        </call>
                                    </args>
                                </call>
                            </body>
                        </for>
                    </start>
                </keyframe>
                <keyframe wait="0.25">
                    <start>
                        <set>
                            <prop>_attack3DirOffset</prop>
                            <value><op>
                                <left><get>_attack3DirOffset</get></left>
                                <op>+</op>
                                <right><json>7.5</json></right>
                            </op></value>
                        </set>
                        <for>
                            <start><json>0</json></start>
                            <stop><json>12</json></stop>
                            <body>
                                <call>
                                    <func>engine.rootEntity.addEntity</func>
                                    <args>
                                        <call>
                                            <func>createProjectile</func>
                                            <args>
                                                <json>"power-5"</json>
                                                <call>
                                                    <func>util.choose</func>
                                                    <args>
                                                        <json>[15, 16, 19]</json>
                                                    </args>
                                                </call>
                                                <json>0.05</json>
                                                <json>1</json>
                                                <get>pos</get>
                                                <op>
                                                    <left><get>_attack3DirOffset</get></left>
                                                    <op>+</op>
                                                    <right><op>
                                                        <left><json>30</json></left>
                                                        <op>*</op>
                                                        <right><get>arg:i</get></right>
                                                    </op></right>
                                                </op>
                                            </args>
                                        </call>
                                    </args>
                                </call>
                            </body>
                        </for>
                    </start>
                </keyframe>
                <keyframe wait="0">
                    <start>
                        <set>
                            <prop>animation</prop>
                            <value><json>"walking"</json></value>
                        </set>
                    </start>
                </keyframe>
            </keyframes>
        </animation>
    </animations>

    <states initial="attacking">
        <state name="attacking">
            <start>
                <set>
                    <prop>attackingTimer</prop>
                    <value><op>
                        <left><json>1</json></left>
                        <op>+</op>
                        <right><op>
                            <left><json>[-0.5, 0.5]</json></left>
                            <op>lerp</op>
                            <right><call>
                                <func>Math.random</func>
                                <args></args>
                            </call></right>
                        </op></right>
                    </op></value>
                </set>
                <if>
                    <cond><op>
                        <left><get>nSlices</get></left>
                        <op>==</op>
                        <right><json>null</json></right>
                    </op></cond>
                    <true>
                        <set>
                            <prop>nSlices</prop>
                            <value><json>5</json></value>
                        </set>
                        <set>
                            <prop>slices</prop>
                            <value><call>
                                <func>copy</func>
                                <args>
                                    <json>[]</json>
                                </args>
                            </call></value>
                        </set>
                        <for>
                            <start><json>0</json></start>
                            <stop><get>nSlices</get></stop>
                            <body>
                                <call>
                                    <func>push</func>
                                    <args>
                                        <get>slices</get>
                                        <call>
                                            <func>createEnemy</func>
                                            <args>
                                                <json>"watermelon-middle"</json>
                                                <get>pos</get>
                                                <json>0</json>
                                                <json>0</json>
                                            </args>
                                        </call>
                                    </args>
                                </call>
                            </body>
                        </for>
                        <for>
                            <of><get>slices</get></of>
                            <body>
                                <call>
                                    <func>engine.rootEntity.addEntity</func>
                                    <args>
                                        <get>arg:value</get>
                                    </args>
                                </call>
                            </body>
                        </for>
                    </true>
                </if>
            </start>
            <continual>
                <set>
                    <prop>attackingTimer</prop>
                    <value><op>
                        <left><get>attackingTimer</get></left>
                        <op>-</op>
                        <right><get>env.delta</get></right>
                    </op></value>
                </set>
                <if>
                    <cond><op>
                        <left><get>attackingTimer</get></left>
                        <op>lt</op>
                        <right><json>0</json></right>
                    </op></cond>
                    <true>
                        <set>
                            <prop>attackType</prop>
                            <value><call>
                                <func>util.choose</func>
                                <args>
                                    <json>[2, 3]</json>
                                </args>
                            </call></value>
                        </set>
                        <set>
                            <prop>state</prop>
                            <value><json>"opening"</json></value>
                        </set>
                    </true>
                </if>
                <call>
                    <func>gazeAt</func>
                    <args>
                        <get>engine.playerEntity.pos</get>
                        <json>0.9</json>
                    </args>
                </call>
                <call>
                    <func>knockInDir</func>
                    <args>
                        <json>0.001</json>
                    </args>
                </call>
                <call>
                    <func>func:place-sides</func>
                    <args>
                        <json>0</json>
                        <json>0</json>
                    </args>
                </call>
            </continual>
        </state>
        <state name="opening">
            <start>
                <set>
                    <prop>openingTimer</prop>
                    <value><json>0.25</json></value>
                </set>
                <set>
                    <prop>dirResetTypes</prop>
                    <value><json>[3]</json></value>
                </set>
                <if>
                    <cond><call>
                        <func>dirResetTypes.includes</func>
                        <args>
                            <get>attackType</get>
                        </args>
                    </call></cond>
                    <true>
                        <set>
                            <prop>dir</prop>
                            <value><json>-90</json></value>
                        </set>
                    </true>
                </if>
            </start>
            <continual>
                <set>
                    <prop>openingTimer</prop>
                    <value><op>
                        <left><get>openingTimer</get></left>
                        <op>-</op>
                        <right><get>env.delta</get></right>
                    </op></value>
                </set>
                <if>
                    <cond><op>
                        <left><get>openingTimer</get></left>
                        <op>lt</op>
                        <right><json>0</json></right>
                    </op></cond>
                    <true>
                        <set>
                            <prop>state</prop>
                            <value><op>
                                <left><json>"attack"</json></left>
                                <op>+</op>
                                <right><get>attackType</get></right>
                            </op></value>
                        </set>
                    </true>
                </if>
                <call>
                    <func>func:place-sides</func>
                    <args>
                        <op>
                            <left><call>
                                <func>util.angleRelDegrees</func>
                                <args>
                                    <json>0</json>
                                    <op>
                                        <left><get>dir</get></left>
                                        <op>+</op>
                                        <right><json>90</json></right>
                                    </op>
                                </args>
                            </call></left>
                            <op>*</op>
                            <right><op>
                                <left><get>openingTimer</get></left>
                                <op>map-rg</op>
                                <right><json>[[0.25, 0], [0, 1]]</json></right>
                            </op></right>
                        </op>
                        <op>
                            <left><get>openingTimer</get></left>
                            <op>map-rg</op>
                            <right><json>[[0.25, 0], [0, 10]]</json></right>
                        </op>
                    </args>
                </call>
            </continual>
        </state>
        <state name="closing">
            <start>
                <set>
                    <prop>closingTimer</prop>
                    <value><json>0.25</json></value>
                </set>
            </start>
            <continual>
                <set>
                    <prop>closingTimer</prop>
                    <value><op>
                        <left><get>closingTimer</get></left>
                        <op>-</op>
                        <right><get>env.delta</get></right>
                    </op></value>
                </set>
                <if>
                    <cond><op>
                        <left><get>closingTimer</get></left>
                        <op>lt</op>
                        <right><json>0</json></right>
                    </op></cond>
                    <true>
                        <set>
                            <prop>state</prop>
                            <value><json>"attacking"</json></value>
                        </set>
                    </true>
                </if>
                <call>
                    <func>func:place-sides</func>
                    <args>
                        <op>
                            <left><call>
                                <func>util.angleRelDegrees</func>
                                <args>
                                    <json>0</json>
                                    <op>
                                        <left><get>dir</get></left>
                                        <op>+</op>
                                        <right><json>90</json></right>
                                    </op>
                                </args>
                            </call></left>
                            <op>*</op>
                            <right><op>
                                <left><get>closingTimer</get></left>
                                <op>map-rg</op>
                                <right><json>[[0.25, 0], [1, 0]]</json></right>
                            </op></right>
                        </op>
                        <op>
                            <left><get>closingTimer</get></left>
                            <op>map-rg</op>
                            <right><json>[[0.25, 0], [6, 0]]</json></right>
                        </op>
                    </args>
                </call>
            </continual>
        </state>
        <state name="attack1">
            <start>
                <set>
                    <prop>shootingTimer</prop>
                    <value><json>3</json></value>
                </set>
            </start>
            <continual>
                <set>
                    <prop>shootingTimer</prop>
                    <value><op>
                        <left><get>shootingTimer</get></left>
                        <op>-</op>
                        <right><get>env.delta</get></right>
                    </op></value>
                </set>
                <if>
                    <cond><op>
                        <left><get>shootingTimer</get></left>
                        <op>lt</op>
                        <right><json>0</json></right>
                    </op></cond>
                    <true>
                        <set>
                            <prop>state</prop>
                            <value><json>"closing"</json></value>
                        </set>
                    </true>
                </if>
                <call>
                    <func>gazeAt</func>
                    <args>
                        <get>engine.playerEntity.pos</get>
                        <json>0.01</json>
                    </args>
                </call>
                <call>
                    <func>func:place-sides</func>
                    <args>
                        <op>
                            <left><get>dir</get></left>
                            <op>+</op>
                            <right><json>90</json></right>
                        </op>
                        <json>6</json>
                    </args>
                </call>
                <call>
                    <func>engine.cameraEntity.addShakeFrom</func>
                    <args>
                        <get>pos</get>
                        <json>0.25</json>
                    </args>
                </call>
            </continual>
        </state>
        <state name="attack2">
            <start>
                <set>
                    <prop>shootingTimer</prop>
                    <value><json>0.5</json></value>
                </set>
                <call>
                    <func>engine.cameraEntity.addShakeFrom</func>
                    <args>
                        <get>pos</get>
                        <json>5</json>
                    </args>
                </call>
                <call>
                    <func>func:place-sides</func>
                    <args>
                        <op>
                            <left><get>dir</get></left>
                            <op>+</op>
                            <right><json>90</json></right>
                        </op>
                        <json>6</json>
                    </args>
                </call>
                <for>
                    <start><json>-1</json></start>
                    <stop><get>nSlices</get></stop>
                    <body>
                        <set>
                            <prop>projX</prop>
                            <value><op>
                                <left><op>
                                    <left><get>innerWidth</get></left>
                                    <op>/</op>
                                    <right><json>-2</json></right>
                                </op></left>
                                <op>+</op>
                                <right><op>
                                    <left><op>
                                        <left><op>
                                            <left><get>arg:i</get></left>
                                            <op>+</op>
                                            <right><json>1.5</json></right>
                                        </op></left>
                                        <op>*</op>
                                        <right><json>6</json></right>
                                    </op></left>
                                    <op>+</op>
                                    <right><op>
                                        <left><op>
                                            <left><get>arg:i</get></left>
                                            <op>+</op>
                                            <right><json>1</json></right>
                                        </op></left>
                                        <op>*</op>
                                        <right><json>8</json></right>
                                    </op></right>
                                </op></right>
                            </op></value>
                        </set>
                        <set>
                            <prop>projPos</prop>
                            <value><call>
                                <func>concat</func>
                                <args>
                                    <op>
                                        <left><op>
                                            <left><op>
                                                <left><get>dirX</get></left>
                                                <op>*</op>
                                                <right><json>1</json></right>
                                            </op></left>
                                            <op>*</op>
                                            <right><get>projX</get></right>
                                        </op></left>
                                        <op>+</op>
                                        <right><get>pos.x</get></right>
                                    </op>
                                    <op>
                                        <left><op>
                                            <left><op>
                                                <left><get>dirY</get></left>
                                                <op>*</op>
                                                <right><json>-1</json></right>
                                            </op></left>
                                            <op>*</op>
                                            <right><get>projX</get></right>
                                        </op></left>
                                        <op>+</op>
                                        <right><get>pos.y</get></right>
                                    </op>
                                </args>
                            </call></value>
                        </set>
                        <set>
                            <prop>explosionEntity</prop>
                            <value><call>
                                <func>createExplosion</func>
                                <args>
                                    <json>15</json>
                                    <json>3</json>
                                    <json>12</json>
                                    <get>projPos</get>
                                </args>
                            </call></value>
                        </set>
                        <set>
                            <prop>explosionEntity.zOffsetY</prop>
                            <value><json>10000000000</json></value>
                        </set>
                        <call>
                            <func>engine.rootEntity.addEntity</func>
                            <args>
                                <get>explosionEntity</get>
                            </args>
                        </call>
                        <call>
                            <func>engine.rootEntity.addEntity</func>
                            <args>
                                <call>
                                    <func>createProjectile</func>
                                    <args>
                                        <json>"yellow-seed"</json>
                                        <json>null</json>
                                        <json>0.2</json>
                                        <json>1</json>
                                        <get>projPos</get>
                                        <op>
                                            <left><get>dir</get></left>
                                            <op>+</op>
                                            <right><op>
                                                <left><json>[-1, 1]</json></left>
                                                <op>lerp</op>
                                                <right><call>
                                                    <func>Math.random</func>
                                                    <args></args>
                                                </call></right>
                                            </op></right>
                                        </op>
                                    </args>
                                </call>
                            </args>
                        </call>
                    </body>
                </for>
            </start>
            <continual>
                <set>
                    <prop>shootingTimer</prop>
                    <value><op>
                        <left><get>shootingTimer</get></left>
                        <op>-</op>
                        <right><get>env.delta</get></right>
                    </op></value>
                </set>
                <if>
                    <cond><op>
                        <left><get>shootingTimer</get></left>
                        <op>lt</op>
                        <right><json>0</json></right>
                    </op></cond>
                    <true>
                        <set>
                            <prop>state</prop>
                            <value><json>"closing"</json></value>
                        </set>
                    </true>
                </if>
                <call>
                    <func>func:place-sides</func>
                    <args>
                        <op>
                            <left><get>dir</get></left>
                            <op>+</op>
                            <right><json>90</json></right>
                        </op>
                        <json>6</json>
                    </args>
                </call>
            </continual>
        </state>
        <state name="attack3">
            <start>
                <call>
                    <func>engine.cameraEntity.addShakeFrom</func>
                    <args>
                        <get>pos</get>
                        <json>5</json>
                    </args>
                </call>
                <set>
                    <prop>explosionEntity</prop>
                    <value><call>
                        <func>createExplosion</func>
                        <args>
                            <json>15</json>
                            <json>3</json>
                            <json>48</json>
                        </args>
                    </call></value>
                </set>
                <set>
                    <prop>explosionEntity.zOffsetY</prop>
                    <value><json>10000000000</json></value>
                </set>
                <call>
                    <func>engine.rootEntity.addEntity</func>
                    <args>
                        <get>explosionEntity</get>
                    </args>
                </call>
                <set>
                    <prop>dirOffset</prop>
                    <value><op>
                        <left><json>360</json></left>
                        <op>*</op>
                        <right><call>
                            <func>Math.random</func>
                            <args></args>
                        </call></right>
                    </op></value>
                </set>
                <set>
                    <prop>animation</prop>
                    <value><json>"attack3"</json></value>
                </set>
                <for>
                    <start><json>0</json></start>
                    <stop><json>72</json></stop>
                    <body>
                        <call>
                            <func>engine.rootEntity.addEntity</func>
                            <args>
                                <call>
                                    <func>createLaunchedProjectile</func>
                                    <args>
                                        <op>
                                            <left><json>"power-"</json></left>
                                            <op>+</op>
                                            <right><call>
                                                <func>util.choose</func>
                                                <args>
                                                    <json>[2, 2, 4]</json>
                                                </args>
                                            </call></right>
                                        </op>
                                        <call>
                                            <func>util.choose</func>
                                            <args>
                                                <json>[15, 16, 19]</json>
                                            </args>
                                        </call>
                                        <op>
                                            <left><call>
                                                <func>Math.random</func>
                                                <args></args>
                                            </call></left>
                                            <op>map-rg</op>
                                            <right><json>[[0, 1], [1, 5]]</json></right>
                                        </op>
                                        <json>1</json>
                                        <json>null</json>
                                        <op>
                                            <left><get>dirOffset</get></left>
                                            <op>+</op>
                                            <right><op>
                                                <left><json>5</json></left>
                                                <op>*</op>
                                                <right><get>arg:i</get></right>
                                            </op></right>
                                        </op>
                                    </args>
                                </call>
                            </args>
                        </call>
                    </body>
                </for>
                <set>
                    <prop>state</prop>
                    <value><json>"attacking"</json></value>
                </set>
            </start>
        </state>
    </states>
</body>